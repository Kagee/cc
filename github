if not http then
  error("The Computercraft HTTP API is not enabled")
end

function main(args)
  if #args < 1 then
    help()
  elseif args[1] == "--update" then
    update_self()
  elseif #args < 4  then
    help()
  else
    for path in string.gmatch(args[4], "[^,]+") do
      dowload(args, path)
    end
  end
end

function download(args, path)
  print("Downloading " .. path)
  url = "https://raw.github.com/"..args[1].."/"..args[2].."/"..args[3].."/"..path
  local content = http.get(url)
  fs.delete(path)
  local file = fs.open(path, "w")
  file.write(content.readAll())
  file.close()
end

function update_self()
  print("Will update self")
  download({"Kagee","cc","master";}, "github")
end

function help()
    print("Arguments:")
    print("github <user> <repo> <branch> <path>")
    print("or")
    print("github <user> <repo> <branch> <paths separated by ,>")
    print("If user is --update script will update itself")
    error()
end

main({...})
